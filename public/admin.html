<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrador - TechStore</title>
    <link rel="shortcut icon" href="https://previews.123rf.com/images/sommersby/sommersby1510/sommersby151000546/46335210-white-flat-shopping-cart-icon-on-a-green-background-vector-illustration.jpg">
    
    <link rel="stylesheet" href="stylesa.css">
    <style>
        /* Estilos adicionales para mejorar la apariencia */
        .admin-user {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-small {
            padding: 8px 12px;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <h1>üõ°Ô∏è PANEL ADMINISTRADOR</h1>
                <p>Ingresa tus credenciales de administrador</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Usuario</label>
                    <input type="text" id="username" class="form-input" required>
                    <span class="error-message" id="usernameError"></span>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Contrase√±a</label>
                    <input type="password" id="password" class="form-input" required>
                    <span class="error-message" id="passwordError"></span>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                     Iniciar Sesi√≥n
                </button>
            </form>
            
            <div id="loginAlert" class="alert alert-danger" style="display: none; margin-top: 1rem;">
                Credenciales incorrectas. Usa: admin
            </div>
        </div>
    </div>

    <div id="adminPanel" class="admin-panel" style="display: none;">
        <header class="admin-header">
            <nav class="admin-nav">
                <div class="admin-logo">üõí TechStore Admin</div>
                <div class="admin-user">
                    <span>üë§ Administrador</span>
                    <button class="btn btn-success btn-small" onclick="goHome(index.html)">
                        üè† Volver al Inicio
                    </button>
                    <button class="btn btn-secondary btn-small" onclick="logout()">
                        üö™ Cerrar Sesi√≥n
                    </button>
                </div>
            </nav>
        </header>

        <aside class="sidebar">
            <ul class="sidebar-menu">
                <li><a href="#" class="menu-link active" data-section="dashboard">üìä Dashboard</a></li>
                <li><a href="#" class="menu-link" data-section="products">üì¶ Productos</a></li>
                <li><a href="#" class="menu-link" data-section="users">üë• Usuarios</a></li>
                <li><a href="#" class="menu-link" data-section="admins">üõ°Ô∏è Administradores</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2 class="section-title">üìä Panel Administrativo</h2>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalProducts">0</div>
                        <div class="stat-label">Total Productos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalUsers">0</div>
                        <div class="stat-label">Usuarios Registrados</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalAdmins">1</div>
                        <div class="stat-label">Administradores</div>
                    </div>
                </div>

                <div class="alert alert-success">
                    <strong>¬°Bienvenido al Panel de Administraci√≥n!</strong><br>
                    Desde aqu√≠ puedes gestionar productos, usuarios y administradores de TechStore.
                </div>
            </section>

            <section id="products" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">üì¶ Gesti√≥n de Productos</h2>
                    <button class="btn btn-primary" onclick="openProductModal()">
                        ‚ûï Nuevo Producto
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Imagen</th>
                                <th>Nombre</th>
                                <th>Precio</th>
                                <th>Descripci√≥n</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="productsTableBody">
                            <!-- Los productos se cargar√°n aqu√≠ -->
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="users" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">üë• Usuarios Registrados</h2>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Fecha de Registro</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Los usuarios se cargar√°n aqu√≠ -->
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="admins" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">üõ°Ô∏è Administradores</h2>
                    <button class="btn btn-primary" onclick="openAdminModal()">
                        ‚ûï Nuevo Administrador
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Fecha de Creaci√≥n</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="adminsTableBody">
                            <!-- Los administradores se cargar√°n aqu√≠ -->
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Modales para productos y administradores -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="productModalTitle">Nuevo Producto</h3>
                <button class="modal-close" onclick="closeProductModal()">&times;</button>
            </div>
            
            <form id="productForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Nombre del Producto *</label>
                        <input type="text" id="productName" class="form-input" required>
                        <span class="error-message" id="productNameError"></span>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Precio *</label>
                        <input type="number" id="productPrice" class="form-input" required min="0">
                        <span class="error-message" id="productPriceError"></span>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">URL de Imagen</label>
                        <input type="url" id="productImage" class="form-input" placeholder="https://ejemplo.com/imagen.jpg">
                        <span class="error-message" id="productImageError"></span>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">Descripci√≥n *</label>
                        <textarea id="productDescription" class="form-input form-textarea" required></textarea>
                        <span class="error-message" id="productDescriptionError"></span>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeProductModal()">
                        ‚ùå Cancelar
                    </button>
                    <button type="submit" class="btn btn-success">
                        üíæ Guardar Producto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="adminModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nuevo Administrador</h3>
                <button class="modal-close" onclick="closeAdminModal()">&times;</button>
            </div>
            
            <form id="adminForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Nombre Completo *</label>
                        <input type="text" id="adminName" class="form-input" required>
                        <span class="error-message" id="adminNameError"></span>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email *</label>
                        <input type="email" id="adminEmail" class="form-input" required>
                        <span class="error-message" id="adminEmailError"></span>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Contrase√±a *</label>
                        <input type="password" id="adminPassword" class="form-input" required minlength="6">
                        <span class="error-message" id="adminPasswordError"></span>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirmar Contrase√±a *</label>
                        <input type="password" id="adminConfirmPassword" class="form-input" required>
                        <span class="error-message" id="adminConfirmPasswordError"></span>
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeAdminModal()">
                        ‚ùå Cancelar
                    </button>
                    <button type="submit" class="btn btn-success">
                        üíæ Crear Administrador
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ===== FUNCIONES PARA LOS BOTONES DE ADMINISTRADOR =====
        
        // Funci√≥n para volver a la p√°gina de inicio (index.html)
        function goHome() {
            // Redirigir a la p√°gina principal
            window.location.href = 'index.html';
        }
        
        // Funci√≥n para cerrar sesi√≥n
        function logout() {
            // Limpiar cualquier dato de sesi√≥n si existe
            if (typeof(Storage) !== "undefined") {
                localStorage.removeItem('adminLoggedIn');
                sessionStorage.removeItem('adminSession');
            }
            
            // Mostrar mensaje de confirmaci√≥n
            alert('Sesi√≥n cerrada correctamente');
            
            // Redirigir al formulario de login
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('loginForm').reset();
            document.getElementById('loginAlert').style.display = 'none';
        }

        // ===== RESTAURAR EL C√ìDIGO ORIGINAL (con peque√±as mejoras) =====
        
        // Datos simulados en memoria
        let products = [
            {
                id: 1,
                name: "Smartphone Pro Max",
                price: 499990,
                image: "imagenes/Pro_Max.jpg",
                description: "√öltimo modelo con c√°mara avanzada de 108MP y procesador de √∫ltima generaci√≥n."
            },
            {
                id: 2,
                name: "Aud√≠fonos Wireless Pro",
                price: 199990,
                image: "imagenes/Wireless_Pro.jpeg",
                description: "Aud√≠fonos inal√°mbricos con cancelaci√≥n de ruido activa y 30hrs de bater√≠a."
            },
            {
                id: 3,
                name: "Laptop Gaming Pro",
                price: 599990,
                image: "imagenes/Laptop_Gaming_Pro.jpg",
                description: "Laptop de alto rendimiento para gaming y trabajo profesional."
            }
        ];

        let users = [
            {
                id: 1,
                name: "Juan P√©rez",
                email: "juan@duocexample.com",
                registrationDate: "2025-09-15"
            },
            {
                id: 2,
                name: "Mar√≠a Garc√≠a",
                email: "maria@duocexample.com",
                registrationDate: "2025-09-15"
            }
        ];

        let admins = [
            {
                id: 1,
                name: "Super Admin",
                email: "admin@duoctechstore.com",
                creationDate: "2025-09-13"
            }
        ];

        let editingProductId = null;
        let nextId = Math.max(...products.map(p => p.id), 0) + 1;

        // Funciones de Login
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            // Validaciones en tiempo real
            let isValid = true;
            
            if (username === '') {
                showFieldError('username', 'El usuario es requerido');
                isValid = false;
            } else {
                clearFieldError('username');
            }
            
            if (password === '') {
                showFieldError('password', 'La contrase√±a es requerida');
                isValid = false;
            } else {
                clearFieldError('password');
            }
            
            if (isValid) {
                if (username === 'admin' && password === 'admin') {
                    // Guardar estado de login
                    if (typeof(Storage) !== "undefined") {
                        localStorage.setItem('adminLoggedIn', 'true');
                    }
                    
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    loadDashboard();
                } else {
                    document.getElementById('loginAlert').style.display = 'block';
                }
            }
        });

        // Validaci√≥n en tiempo real para login
        document.getElementById('username').addEventListener('input', function() {
            if (this.value.trim() !== '') {
                clearFieldError('username');
            }
        });

        document.getElementById('password').addEventListener('input', function() {
            if (this.value.trim() !== '') {
                clearFieldError('password');
            }
        });

        function showFieldError(fieldName, message) {
            const field = document.getElementById(fieldName);
            const errorSpan = document.getElementById(fieldName + 'Error');
            field.classList.add('error');
            errorSpan.textContent = message;
        }

        function clearFieldError(fieldName) {
            const field = document.getElementById(fieldName);
            const errorSpan = document.getElementById(fieldName + 'Error');
            field.classList.remove('error');
            errorSpan.textContent = '';
        }

        // Navegaci√≥n del men√∫
        document.querySelectorAll('.menu-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const sectionName = this.dataset.section;
                
                // Actualizar enlaces activos
                document.querySelectorAll('.menu-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                // Mostrar secci√≥n
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                document.getElementById(sectionName).classList.add('active');
                
                // Cargar datos seg√∫n la secci√≥n
                switch(sectionName) {
                    case 'dashboard':
                        loadDashboard();
                        break;
                    case 'products':
                        loadProducts();
                        break;
                    case 'users':
                        loadUsers();
                        break;
                    case 'admins':
                        loadAdmins();
                        break;
                }
            });
        });

        // Dashboard
        function loadDashboard() {
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalAdmins').textContent = admins.length;
        }

        // Gesti√≥n de Productos
        function loadProducts() {
            const tbody = document.getElementById('productsTableBody');
            tbody.innerHTML = '';
            
            products.forEach(product => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td><img src="${product.image}" alt="${product.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;"></td>
                    <td>${product.name}</td>
                    <td>$${product.price.toLocaleString()}</td>
                    <td>${product.description}</td>
                    <td>
                        <button class="btn btn-warning btn-small" onclick="editProduct(${product.id})">
                            ‚úèÔ∏è Editar
                        </button>
                        <button class="btn btn-danger btn-small" onclick="deleteProduct(${product.id})">
                            üóëÔ∏è Eliminar
                        </button>
                    </td>
                `;
            });
        }

        function openProductModal(productId = null) {
            editingProductId = productId;
            const modal = document.getElementById('productModal');
            const title = document.getElementById('productModalTitle');
            const form = document.getElementById('productForm');
            
            if (productId) {
                // Editar producto existente
                const product = products.find(p => p.id === productId);
                title.textContent = 'Editar Producto';
                document.getElementById('productName').value = product.name;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productImage').value = product.image;
                document.getElementById('productDescription').value = product.description;
            } else {
                // Nuevo producto
                title.textContent = 'Nuevo Producto';
                form.reset();
            }
            
            // Limpiar errores
            clearAllProductErrors();
            modal.classList.add('active');
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
            document.getElementById('productForm').reset();
            clearAllProductErrors();
            editingProductId = null;
        }

        function clearAllProductErrors() {
            ['productName', 'productPrice', 'productImage', 'productDescription'].forEach(field => {
                clearFieldError(field);
            });
        }

        // Validaciones en tiempo real para productos
        document.getElementById('productName').addEventListener('input', function() {
            if (this.value.trim() !== '') {
                clearFieldError('productName');
            }
        });

        document.getElementById('productPrice').addEventListener('input', function() {
            if (this.value > 0) {
                clearFieldError('productPrice');
            }
        });

        document.getElementById('productImage').addEventListener('input', function() {
            if (this.value === '' || isValidURL(this.value)) {
                clearFieldError('productImage');
            }
        });

        document.getElementById('productDescription').addEventListener('input', function() {
            if (this.value.trim() !== '') {
                clearFieldError('productDescription');
            }
        });

        function isValidURL(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('productName').value.trim();
            const price = parseFloat(document.getElementById('productPrice').value);
            const image = document.getElementById('productImage').value.trim();
            const description = document.getElementById('productDescription').value.trim();
            
            let isValid = true;
            
            // Validaciones
            if (name === '') {
                showFieldError('productName', 'El nombre es requerido');
                isValid = false;
            }
            
            if (price <= 0 || isNaN(price)) {
                showFieldError('productPrice', 'El precio debe ser mayor a 0');
                isValid = false;
            }
            
            if (description === '') {
                showFieldError('productDescription', 'La descripci√≥n es requerida');
                isValid = false;
            }

            if (image !== '' && !isValidURL(image)) {
                showFieldError('productImage', 'URL de imagen no v√°lida');
                isValid = false;
            }
            
            if (!isValid) {
                return;
            }

            if (editingProductId) {
                // Actualizar producto
                const product = products.find(p => p.id === editingProductId);
                if (product) {
                    product.name = name;
                    product.price = price;
                    product.image = image;
                    product.description = description;
                }
            } else {
                // Crear nuevo producto
                const newProduct = {
                    id: nextId++,
                    name: name,
                    price: price,
                    image: image,
                    description: description
                };
                products.push(newProduct);
            }
            
            closeProductModal();
            loadProducts();
            loadDashboard(); // Actualizar el contador del dashboard
        });

        function editProduct(productId) {
            openProductModal(productId);
        }

        function deleteProduct(productId) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este producto?')) {
                products = products.filter(p => p.id !== productId);
                loadProducts();
                loadDashboard();
            }
        }

        // Gesti√≥n de Usuarios
        function loadUsers() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.registrationDate}</td>
                    <td>
                        <button class="btn btn-danger btn-small" onclick="deleteUser(${user.id})">
                            üóëÔ∏è Eliminar
                        </button>
                    </td>
                `;
            });
        }

        function deleteUser(userId) {
            if (confirm('¬øEst√°s seguro de que quieres eliminar este usuario?')) {
                users = users.filter(u => u.id !== userId);
                loadUsers();
                loadDashboard();
            }
        }

        // Gesti√≥n de Administradores
        function loadAdmins() {
            const tbody = document.getElementById('adminsTableBody');
            tbody.innerHTML = '';
            
            admins.forEach(admin => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${admin.name}</td>
                    <td>${admin.email}</td>
                    <td>${admin.creationDate}</td>
                    <td>
                        <button class="btn btn-danger btn-small" onclick="deleteAdmin(${admin.id})">
                            üóëÔ∏è Eliminar
                        </button>
                    </td>
                `;
            });
        }

        function openAdminModal() {
            const modal = document.getElementById('adminModal');
            const form = document.getElementById('adminForm');
            form.reset();
            clearAllAdminErrors();
            modal.classList.add('active');
        }

        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('active');
            document.getElementById('adminForm').reset();
            clearAllAdminErrors();
        }

        function clearAllAdminErrors() {
            ['adminName', 'adminEmail', 'adminPassword', 'adminConfirmPassword'].forEach(field => {
                clearFieldError(field);
            });
        }

        document.getElementById('adminForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('adminName').value.trim();
            const email = document.getElementById('adminEmail').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            const confirmPassword = document.getElementById('adminConfirmPassword').value.trim();
            
            let isValid = true;
            
            // Validaciones
            if (name === '') {
                showFieldError('adminName', 'El nombre es requerido');
                isValid = false;
            }
            
            if (email === '') {
                showFieldError('adminEmail', 'El email es requerido');
                isValid = false;
            }
            
            if (password.length < 6) {
                showFieldError('adminPassword', 'La contrase√±a debe tener al menos 6 caracteres');
                isValid = false;
            }
            
            if (password !== confirmPassword) {
                showFieldError('adminConfirmPassword', 'Las contrase√±as no coinciden');
                isValid = false;
            }

            if (!isValid) {
                return;
            }

            const newAdmin = {
                id: admins.length > 0 ? Math.max(...admins.map(a => a.id)) + 1 : 1,
                name: name,
                email: email,
                creationDate: new Date().toISOString().slice(0, 10)
            };
            admins.push(newAdmin);
            
            closeAdminModal();
            loadAdmins();
            loadDashboard();
        });

        function deleteAdmin(adminId) {
            if (admins.length <= 1) {
                alert('No se puede eliminar al √∫ltimo administrador.');
                return;
            }
            if (confirm('¬øEst√°s seguro de que quieres eliminar a este administrador?')) {
                admins = admins.filter(a => a.id !== adminId);
                loadAdmins();
                loadDashboard();
            }
        }
        
        // Cargar datos iniciales al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            // Verificar si ya est√° logueado
            if (typeof(Storage) !== "undefined" && localStorage.getItem('adminLoggedIn') === 'true') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadDashboard();
            } else {
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('adminPanel').style.display = 'none';
            }
            
            loadProducts();
            loadUsers();
            loadAdmins();
        });
    </script>
</body>
</html>